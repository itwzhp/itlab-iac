---
- name: Install system tools
  hosts: localhost # tylko nasz lokalny komputer
  connection: local # połączenie lokalne, bez SSH
  become: yes # uzyskaj uprawnienia roota
  gather_facts: yes # zbierz fakty o systemie - przydatne do warunkowania zadań

  tasks:
    - name: Update package cache
      ansible.builtin.apt:
        update_cache: yes
      tags:
        - always

    - name: Install text editors
      ansible.builtin.apt:
        name:
          - vim
          - nano
        state: present
      tags:
        - install_text_editors
        - packages

    - name: Install monitoring tools
      ansible.builtin.apt:
        name:
          - htop
          - atop
        state: present
      tags:
        - install_monitoring_tools
        - packages

    - name: Create index.html file
      ansible.builtin.copy:
        content: "Hello World!"
        dest: ./index.html
        mode: '0777' # Ustaw uprawnienia

    - name: Remove installed monitoring tools
      ansible.builtin.apt:
        name:
          - htop
          - atop
        state: absent
      tags:
        - never
        - remove_monitoring_tools
